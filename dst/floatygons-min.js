'use strict';//Floatygons.js
//By Styn van de Haterd @ 2019
function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Floatygons=function a(){var b=this;_classCallCheck(this,a),_defineProperty(this,"extendDefaults",function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}),_defineProperty(this,"getRandom",function(a,b){return Math.floor(Math.random()*(b-a+1))+a}),_defineProperty(this,"increaseBrightness",function(a,b){var d=Math.round,e=Math.min,f=Math.max;a=(a+"").replace(/[^0-9a-f]/gi,""),6>a.length&&(a=a.replace(/(.)/g,"$1$1")),b=b||0;for(var g,h="#",j=0;3>j;++j)g=parseInt(a.substr(2*j,2),16),g=d(e(f(0,g+g*b),255)).toString(16),h+=("00"+g).substr(g.length);return h}),_defineProperty(this,"spawnDot",function(){return{x:b.getRandom(0,b.canvasWidth),y:b.getRandom(0,b.canvasHeight),vx:b.getRandom(-b.options.maxDotSpeed,b.options.maxDotSpeed),vy:b.getRandom(-b.options.maxDotSpeed,b.options.maxDotSpeed),markedForDeletion:!1,connections:[]}}),_defineProperty(this,"manhattanDistance",function(a,b){var c=Math.abs;return c(b.x-a.x)+c(b.y-a.y)}),_defineProperty(this,"seekConnection",function(a){var c=!0,d=!1,e=void 0;try{for(var f,g,h=function(){var c=f.value;if(c===a)return"continue";var d=b.manhattanDistance(a,c);if(d<b.options.maxDistance&&0===c.connections.filter(function(b){return b===a}).length&&0===a.connections.filter(function(a){return a===c}).length)return{v:c}},i=b.dots[Symbol.iterator]();!(c=(f=i.next()).done);c=!0)switch(g=h(),g){case"continue":continue;default:if("object"===_typeof(g))return g.v;}}catch(a){d=!0,e=a}finally{try{c||null==i["return"]||i["return"]()}finally{if(d)throw e}}}),_defineProperty(this,"setup",function(){b.canvas=document.querySelector(b.options.canvasId),b.ctx=b.canvas.getContext("2d");var a=b.canvas.parentElement;b.ctx.canvas.width=a.clientWidth,b.ctx.canvas.height=a.clientHeight,b.canvasWidth=b.ctx.canvas.width,b.canvasHeight=b.ctx.canvas.height;for(var c=0;c<b.options.maxDotsAlive;++c)b.dots.push(b.spawnDot())}),_defineProperty(this,"clearScreen",function(){b.ctx.fillStyle=b.options.clearColor,b.ctx.fillRect(0,0,b.canvasWidth,b.canvasHeight)}),_defineProperty(this,"drawLine",function(a,c){b.ctx.strokeStyle=b.increaseBrightness(b.options.lineColor,-(b.manhattanDistance(a,c)/b.options.maxDistance)+.075),b.ctx.beginPath(),b.ctx.moveTo(a.x+b.options.dotSize/2,a.y+b.options.dotSize/2),b.ctx.lineTo(c.x+b.options.dotSize/2,c.y+b.options.dotSize/2),b.ctx.stroke()}),_defineProperty(this,"drawDot",function(a){var c=!0,d=!1,e=void 0;try{for(var f,g,h=a.connections[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,b.drawLine(a,g)}catch(a){d=!0,e=a}finally{try{c||null==h["return"]||h["return"]()}finally{if(d)throw e}}b.ctx.fillStyle=b.options.dotColor,b.ctx.fillRect(a.x,a.y,b.options.dotSize,b.options.dotSize)}),_defineProperty(this,"updateDot",function(a){//Check positioning for deletion
if(a.x+=a.vx*(b.options.interval/1e3),a.y+=a.vy*(b.options.interval/1e3),a.x>b.canvasWidth||0>a.x||a.y>b.canvasHeight||0>a.y)return void(a.markedForDeletion=!0);//Check if new connections available
if(a.connections.length<b.options.maxConnections){var c=b.seekConnection(a);void 0!==c&&a.connections.push(c)}//Check existing connections
for(var d=a.connections.length-1;0<=d;)(a.connections[d].markedForDeletion||b.manhattanDistance(a,a.connections[d])>b.options.maxDistance)&&a.connections.splice(d,1),--d}),_defineProperty(this,"update",function(){b.clearScreen();for(var a,c=b.dots.length-1,d=0;0<=c;){//Remove dot if needed.
if(a=b.dots[c],b.updateDot(a),a.markedForDeletion){b.dots.splice(c,1),++d,--c;continue}//Draw
b.drawDot(a),--c}for(var e=0;e<d;++e)b.dots.push(b.spawnDot())}),_defineProperty(this,"start",function(){b.setup(),b.clearScreen(),setInterval(b.update,b.options.interval)}),_defineProperty(this,"stop",function(){b.options.interval=0}),_defineProperty(this,"resume",function(){b.options.interval=1e3/b.options.fps});var c={canvasId:"#floatygonCanvas",clearColor:"#1b1b1b",dotColor:"#FFFFFF",lineColor:"#FFFFFF",maxDotsAlive:128,dotSize:3,maxDotSpeed:20,maxConnections:3,maxDistance:200,fps:144};this.options=arguments[0]&&"object"===_typeof(arguments[0])?this.extendDefaults(c,arguments[0]):c,this.options.interval=1e3/this.options.fps,this.dots=[]};